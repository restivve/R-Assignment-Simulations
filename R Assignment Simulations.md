---
title: "R Assignment Simulations"
author: "Victoria Restivo"
date: '2018-11-28'
output: 
 html_document: 
    keep_md: yes
---



#1-Datacamp - completed course "Bioconductors"

#2-General simulator for diploids

##deterministic model

```r
p_t1 <- function(w_AA, w_aa, w_Aa, p_t0, q_t0) {
w_bar <- (((p_t0)^2)*w_AA) + (2 * p_t0 * q_t0 * w_Aa) + (((q_t0)^2)*w_aa)
p_t1 <- (((p_t0)^2)*(w_AA/w_bar)) + ((p_t0*q_t0)*(w_Aa/w_bar))
return(p_t1)
}

p_t1(w_AA = 1.0, w_aa = 1.0, w_Aa = 0.5, p_t0 = 0.5, q_t0 = 0.5)
```

```
## [1] 0.5
```

##Multi-generation model

```r
diploid_selection <- function(p0 = 0.01, w1 = 1, w2 = 0.95, w3 = 0.9,  n = 500) {
    
    # Initialize vectors to store allele frequencies and mean pop fitness
    p <- rep(NA,n)  # a vector to store allele frequencies
    
    w_bar <- rep(NA, n)
     
    # starting conditions
   	p[1] <- p0 # starting allele frequencies

	  w_bar[1] <- (p[1]^2*w1) + ((2*p[1]*(1-p[1]))*w2) + ((1-p[1])^2)*w3
	
	
	# now we need to loop from generation to generation
	for ( i in 2:n) {
		w_bar[i - 1] <- (p[i-1]^2*w1) + ((2*p[i-1]*(1-p[i-1]))*w2) + ((1-p[i-1])^2)*w3 # mean population fitness
		p[i] <- ((p[i - 1]^2) * (w1/w_bar[i - 1])) + (p[i-1]*(1-p[i-1]))*(w2/w_bar[i-1])
	}
	  
    if (p > 0.9999) {
    fixation <- min(which.max(p > 0.9999))
    print("fixation for A1 occurs approximately at generation:", fixation )	
    } else {
        maxAlleleFreq <- max(p)
    	print("fixation of A1 does not occur, max. allele frequency is:", print(maxAlleleFreq, digits = 2) )
    }
	  
#plots
par(mfrow=c(2,2))
 
#change in allele frequency over time
plot(x = 1:n, y = p, 
     xlab="generations", 
	 ylab="Allele frequency (p)", 
	 pch = 20, col = "red", cex.lab = 1.5)

}

diploid_selection()
```

```
## Warning in if (p > 0.9999) {: the condition has length > 1 and only the
## first element will be used
```

```
## [1] 1
## [1] "fixation of A1 does not occur, max. allele frequency is:"
```

![](Assignment_4_files/figure-html/unnamed-chunk-2-1.png)<!-- -->

#Question 3

```r
genetic_drift_sim<- function(a, HD, ind, gen) {
  alleles <- c(sample(c("a", "A"), 
                      size = HD*(ind), 
                      replace = TRUE, 
                      prob = c(a, 1 - a)))

  allelefreq <- matrix(data = NA, nrow = gen, ncol = 2)

  for(i in 1:gen){
    alleles <- sample(alleles, HD*ind, replace=TRUE)
    allelefreq[i,2] <- (length(alleles[alleles =="A"]))/(HD*(ind))
    allelefreq[i,1] <- (length(alleles[alleles =="a"]))/(HD*(ind))
  }

 a <- allelefreq[,1]
 A <- allelefreq[,2]

 plot(1, type="n", xlim=c(1,gen), ylim=c(0,1), xlab="generation", ylab="Frequency Of Alleles")
 lines(x = A, type = "l", col = "red")
 lines(x = a, type = "l", col = "blue")
 legend("topleft", legend=c("A Frequency", "a Frequency"),
       col=c("red", "blue"), lty=1, cex=0.8)
}

genetic_drift_sim(0.5, 2, 20, 100)
```

![](Assignment_4_files/figure-html/unnamed-chunk-3-1.png)<!-- -->

#Question 4

```r
lost_allele <- function(A, gen, runs) {
  
A_prop1 <- matrix(data = NA, nrow = runs, ncol = 1)

for(j in 1:runs){
alleles <- c(sample(c("a", "A"), size = 400, replace = TRUE, prob = c(1 - A, A)))
A_prop <- integer()

for(i in 1:gen) {
alleles <- sample(alleles, 400, replace=TRUE)
A_freq <- (length(alleles[alleles =="A"]))/(400)
A_prop[i] <- A_freq
}

A_prop1[j,1] <- tail(A_prop, n = 1)
}

zerocount <- (length(which(A_prop1[,1] == "0")))
print(zerocount/runs)
}

lost_allele(0.1, 100, 1000)
```

```
## [1] 0.44
```

#Question 5

##2 generations

```r
allele_counts <- sample(c("A", "a"), 
                        size=40,
                        replace=TRUE,
                        prob=c(0.5, 0.5))
allele_freq1 <- table(allele_counts)/length(allele_counts)

allele_freq1
```

```
## allele_counts
##     a     A 
## 0.325 0.675
```

```r
allele_counts2 <- sample(c("A", "a"),
                         size=40,
                         replace=TRUE,
                         prob=allele_freq1)

allele_freq2 <- table(allele_counts2)/length(allele_counts2)

allele_freq2
```

```
## allele_counts2
##    a    A 
## 0.65 0.35
```

##100 generations

```r
allele_trajectories <- function(A, gen, runs) {

plot(1, type="n", xlim=c(1,gen), ylim=c(0,1), xlab="Generation", ylab="Allele Frequency", main = "The Influence of Genetic Drift on Allele Frequencies")

for(j in 1:runs){
alleles <- c(sample(c("a", "A"), size = 400, replace = TRUE, prob = c(1 - A, A)))
Aprop <- integer()


for(i in 1:gen) {
alleles <- sample(alleles, 400, replace=TRUE)
Afreq <- (length(alleles[alleles =="A"]))/(400)
Aprop[i] <- Afreq
}
lines(x = Aprop, type = "l", col = sample(rainbow(n= runs)), lwd=2)

}

}

allele_trajectories(0.5, 100, 100)
```

![](Assignment_4_files/figure-html/unnamed-chunk-6-1.png)<!-- -->


#Question 6


```r
sig_pval <- function(a, b, lo, sd) {
x <- seq(from =1, to = 10, length.out=lo) 
y_deterministic <- a + b*x
y_simulated <- rnorm(length(x), mean = y_deterministic, sd)
mod_sim <- lm(y_simulated ~ x)

p_val_slope <- summary(mod_sim)$coef[2,4] 
p_val_slope
}

sig_pval(a=0.5, b=0.1, lo=20, sd=2)
```

```
## [1] 0.1742155
```

```r
# to confirm it works and you get the same answer every time, put set.seed(720) in the function
```


```r
# Run 1000 times
set.seed(720)
sig_pval <- function(a, b, lo, sd) {
x <- seq(from =1, to = 10, length.out=lo) 
y_deterministic <- a + b*x
y_simulated <- rnorm(length(x), mean = y_deterministic, sd)
mod_sim <- lm(y_simulated ~ x)

p_val_slope <- summary(mod_sim)$coef[2,4] 
p_val_slope
}

sig_pval(a=0.5, b=0.1, lo=20, sd=2)
```

```
## [1] 0.3620625
```

```r
thousand_times <- replicate(1000, sig_pval(a=0.5, b=0.1, lo=20, sd=2))
thousand_times
```

```
##    [1] 2.179742e-01 3.250347e-01 6.773251e-01 1.576037e-01 5.441501e-01
##    [6] 1.007433e-03 2.201029e-01 6.975654e-01 6.606277e-01 4.835129e-01
##   [11] 8.112564e-01 3.900507e-01 3.466113e-02 4.148178e-02 6.738336e-01
##   [16] 1.633329e-01 2.636953e-01 5.810497e-02 7.851598e-01 1.848648e-01
##   [21] 5.483996e-01 7.080474e-01 7.212014e-01 4.729719e-01 4.766000e-01
##   [26] 6.818067e-01 4.396742e-01 7.749069e-03 1.015833e-01 5.703351e-01
##   [31] 3.634565e-01 9.813788e-01 2.793681e-01 5.931720e-02 6.664284e-01
##   [36] 7.603054e-01 2.127487e-01 1.120763e-01 9.937682e-01 2.856012e-02
##   [41] 1.999686e-01 9.873524e-01 5.708408e-01 1.130203e-01 1.702491e-01
##   [46] 3.324787e-01 3.790619e-01 1.304577e-02 6.314435e-01 3.514090e-01
##   [51] 6.130958e-02 4.298099e-01 9.062174e-01 9.879182e-01 5.750605e-01
##   [56] 3.996420e-01 5.603294e-01 1.628603e-01 4.492567e-01 6.813689e-01
##   [61] 8.136940e-01 2.311672e-01 3.047447e-01 7.748595e-01 5.165221e-01
##   [66] 2.159794e-01 8.896487e-01 2.491711e-02 3.876010e-01 8.988911e-01
##   [71] 3.672536e-01 9.346059e-02 6.540864e-01 7.308311e-01 6.438120e-01
##   [76] 4.181689e-03 9.144363e-01 6.198023e-01 5.022603e-01 6.552937e-01
##   [81] 6.430365e-01 8.924738e-01 3.442210e-01 8.111201e-01 4.669322e-01
##   [86] 3.861079e-01 8.345782e-01 1.437863e-02 2.034951e-02 5.627751e-01
##   [91] 1.030542e-01 2.130181e-01 8.095348e-01 3.011535e-02 5.375339e-02
##   [96] 8.223945e-01 1.093129e-01 7.090895e-01 2.638729e-01 5.195584e-02
##  [101] 9.504174e-01 3.750734e-01 9.482855e-01 7.492319e-01 8.497751e-01
##  [106] 1.042858e-01 2.162826e-02 4.962995e-01 6.430072e-01 2.859791e-01
##  [111] 5.247285e-01 9.810545e-01 5.833045e-01 6.157768e-01 8.711306e-01
##  [116] 9.863821e-01 9.743843e-01 2.998329e-01 3.457218e-01 4.346883e-02
##  [121] 9.395017e-01 7.526150e-02 3.871075e-01 3.371675e-02 1.483404e-01
##  [126] 1.039360e-01 2.691175e-04 7.484051e-01 6.819799e-01 6.009453e-01
##  [131] 8.961021e-01 6.930100e-01 2.244741e-01 3.320015e-01 2.811882e-01
##  [136] 3.917816e-01 5.687133e-01 1.736253e-01 1.883761e-01 9.110864e-01
##  [141] 7.487876e-01 8.946664e-01 9.952748e-01 9.948894e-01 1.339284e-02
##  [146] 9.627977e-01 1.123933e-01 2.727885e-01 1.445484e-01 1.527471e-01
##  [151] 2.283493e-01 3.122143e-01 3.270594e-02 2.574077e-01 2.681685e-02
##  [156] 1.559617e-01 9.868742e-01 5.608072e-01 5.084820e-01 5.973449e-02
##  [161] 4.477408e-01 5.110492e-01 8.231946e-01 7.632554e-01 2.323823e-01
##  [166] 2.388414e-01 1.353312e-01 6.002708e-01 6.249877e-01 1.303373e-01
##  [171] 3.646693e-01 9.260101e-01 3.230141e-02 1.203667e-01 1.089671e-01
##  [176] 2.059799e-01 3.873888e-02 7.770711e-01 7.348462e-01 7.842586e-01
##  [181] 7.871783e-01 5.752551e-01 3.300479e-01 8.559460e-01 2.906330e-02
##  [186] 8.276584e-01 4.054576e-01 2.503681e-01 3.001522e-01 9.409666e-01
##  [191] 4.850583e-01 8.685519e-04 7.723661e-01 8.665487e-01 2.838611e-01
##  [196] 3.043516e-01 5.543853e-01 7.538295e-01 2.673668e-01 7.498380e-01
##  [201] 2.754714e-01 3.124969e-02 7.469719e-01 4.223396e-01 6.923316e-01
##  [206] 6.440534e-02 3.093198e-01 6.391186e-01 5.481279e-01 2.579110e-01
##  [211] 1.595914e-01 8.444199e-01 9.227119e-01 8.101470e-02 8.012112e-01
##  [216] 5.995737e-01 9.191804e-01 5.839609e-01 2.722941e-01 9.116943e-01
##  [221] 8.411552e-01 9.142094e-01 9.993046e-01 2.500437e-01 7.422406e-01
##  [226] 9.187816e-01 1.417572e-02 5.179236e-01 7.192999e-01 5.798158e-01
##  [231] 3.526107e-02 9.768173e-01 5.139095e-01 6.955825e-02 6.825026e-01
##  [236] 6.373149e-01 2.621571e-01 1.622432e-01 6.066569e-01 1.908725e-02
##  [241] 4.697093e-02 5.770061e-01 6.605432e-01 7.386166e-01 6.147970e-04
##  [246] 1.748147e-01 1.214207e-01 3.016164e-02 5.091768e-02 2.087215e-01
##  [251] 9.592026e-01 4.279704e-01 6.383671e-02 6.945340e-01 3.383116e-01
##  [256] 2.855116e-01 1.052696e-02 5.756426e-01 1.162527e-01 8.871356e-01
##  [261] 1.670102e-01 3.010372e-01 2.847491e-01 5.007955e-01 5.982221e-01
##  [266] 3.763866e-01 1.199275e-01 6.798243e-01 4.648293e-01 7.848886e-01
##  [271] 6.466718e-01 9.632274e-01 4.911297e-01 4.909033e-01 5.626621e-01
##  [276] 8.049257e-01 5.897046e-01 8.301206e-02 4.932869e-01 4.081912e-01
##  [281] 7.353590e-01 4.722874e-01 9.952082e-01 6.447625e-01 8.018588e-01
##  [286] 9.181699e-01 2.737665e-01 8.117453e-01 1.453657e-01 8.789220e-01
##  [291] 7.617736e-01 4.272347e-01 5.683526e-01 6.454528e-01 8.298852e-01
##  [296] 3.381098e-01 1.296026e-02 1.703066e-01 9.054366e-02 6.629997e-01
##  [301] 5.622800e-01 2.602501e-01 7.029228e-03 3.090225e-01 2.420932e-01
##  [306] 9.895646e-01 8.330494e-02 4.956868e-01 2.569575e-01 5.425645e-01
##  [311] 3.225155e-01 8.007155e-01 5.325909e-01 3.973046e-01 2.412333e-01
##  [316] 5.654638e-01 3.075307e-01 4.153122e-01 4.066676e-01 6.319024e-02
##  [321] 7.108710e-01 8.992868e-02 9.923362e-01 2.273910e-02 5.279708e-01
##  [326] 5.024527e-02 6.749757e-01 2.481024e-01 7.438477e-02 9.730285e-01
##  [331] 4.541859e-01 2.545920e-01 2.968693e-02 7.826279e-01 4.867012e-01
##  [336] 2.725356e-01 5.848163e-01 1.540580e-01 2.551961e-01 9.601644e-01
##  [341] 3.279410e-01 8.477622e-01 3.380366e-01 6.707966e-01 6.646828e-01
##  [346] 7.155160e-01 9.687013e-01 4.311828e-03 1.829443e-01 3.886738e-01
##  [351] 7.848233e-01 1.612658e-01 5.093957e-01 5.652293e-01 1.937661e-01
##  [356] 2.072433e-01 2.038218e-01 2.805440e-01 2.336106e-01 4.259256e-01
##  [361] 6.722892e-01 5.010521e-01 6.999247e-03 1.406382e-01 1.518105e-01
##  [366] 2.133986e-01 2.517897e-01 9.715959e-01 8.135686e-01 7.429504e-01
##  [371] 7.862393e-01 6.262667e-01 9.279161e-01 1.947075e-02 4.817538e-02
##  [376] 2.077575e-01 9.795027e-01 1.272764e-01 4.965790e-01 7.262087e-01
##  [381] 6.253939e-01 9.178860e-01 1.319243e-01 1.296978e-01 2.794428e-01
##  [386] 8.623971e-02 2.830564e-04 9.707632e-02 6.846089e-01 7.300270e-01
##  [391] 5.947775e-01 5.274515e-01 8.274097e-01 7.660199e-01 1.647316e-01
##  [396] 1.731383e-01 1.152396e-01 1.260676e-01 5.434691e-01 6.280439e-01
##  [401] 1.546956e-01 4.331069e-01 1.086542e-01 3.315661e-01 2.538839e-01
##  [406] 3.909465e-01 5.030284e-01 5.913657e-01 8.500745e-01 1.063499e-01
##  [411] 9.676540e-01 7.549178e-02 1.985279e-01 4.757178e-01 4.372760e-03
##  [416] 4.548833e-01 8.828335e-01 9.400600e-01 6.363992e-01 5.568911e-01
##  [421] 8.605810e-01 5.151753e-01 4.698971e-01 2.657316e-01 9.475296e-01
##  [426] 1.372985e-01 6.087172e-01 2.202502e-01 3.344562e-01 2.624210e-01
##  [431] 6.579160e-01 9.678383e-01 1.245705e-01 8.657592e-01 8.325096e-01
##  [436] 7.539439e-02 5.464553e-01 6.406136e-01 9.512135e-02 8.723268e-01
##  [441] 9.412874e-01 6.629454e-01 6.176873e-01 8.824573e-01 7.741201e-01
##  [446] 9.640532e-01 2.316922e-01 7.744012e-01 9.491038e-05 1.510046e-01
##  [451] 9.021218e-01 1.462894e-01 6.881724e-01 3.710506e-02 8.544437e-03
##  [456] 2.524633e-01 7.577128e-02 7.379507e-01 4.495202e-01 3.809008e-01
##  [461] 9.642703e-02 2.462096e-01 4.625436e-01 7.141082e-01 8.783448e-01
##  [466] 1.810314e-02 1.330157e-02 4.134867e-01 9.723373e-02 2.510659e-01
##  [471] 5.491318e-01 1.284864e-01 7.331627e-01 9.883022e-02 2.891577e-01
##  [476] 2.828398e-01 7.019218e-01 7.186044e-01 1.518894e-01 5.829718e-01
##  [481] 5.712504e-01 1.180640e-01 4.860934e-01 7.270704e-01 4.527063e-01
##  [486] 2.448163e-02 9.630825e-01 2.676663e-02 7.511995e-01 4.480025e-02
##  [491] 5.043351e-02 1.031060e-01 4.705311e-01 6.846830e-01 1.408809e-01
##  [496] 8.831558e-01 4.857496e-01 5.918050e-01 8.040665e-01 8.979475e-01
##  [501] 1.995310e-01 4.406576e-01 4.308958e-02 4.393903e-02 8.720715e-01
##  [506] 3.748344e-01 1.428654e-01 1.810551e-02 5.906436e-01 3.092957e-01
##  [511] 4.369433e-01 4.813642e-01 4.973678e-01 1.176830e-01 2.266780e-01
##  [516] 2.697808e-01 2.350754e-01 2.278246e-01 1.338797e-01 3.094892e-01
##  [521] 5.398717e-01 6.987383e-01 1.680444e-01 4.255101e-01 5.561103e-01
##  [526] 5.749235e-01 1.729787e-01 9.338172e-01 9.065941e-01 7.610467e-01
##  [531] 5.916040e-01 8.361448e-01 7.792859e-02 3.987316e-01 7.126988e-01
##  [536] 5.783493e-01 4.772013e-01 7.902055e-01 3.595618e-02 4.391281e-01
##  [541] 6.999876e-01 3.607051e-01 8.689779e-01 9.367874e-01 9.439411e-01
##  [546] 6.710324e-01 6.767498e-02 4.334584e-01 1.899376e-01 1.615560e-01
##  [551] 1.485240e-01 2.179730e-01 7.655095e-01 1.422485e-01 6.664562e-01
##  [556] 2.825216e-01 2.670924e-02 9.920830e-01 1.197561e-01 3.571606e-01
##  [561] 3.577890e-01 8.955790e-01 7.817629e-01 2.131255e-01 2.778351e-03
##  [566] 1.456815e-01 9.795120e-01 8.953910e-01 7.895456e-01 3.618227e-01
##  [571] 6.571891e-01 3.614322e-02 3.529408e-01 3.324894e-01 9.218968e-01
##  [576] 4.229152e-02 7.839007e-01 4.095231e-01 9.798387e-01 7.681084e-01
##  [581] 1.424900e-01 9.174558e-01 1.316779e-02 2.424134e-01 9.692425e-02
##  [586] 5.569051e-01 9.524749e-01 1.111418e-02 2.242447e-01 6.889789e-01
##  [591] 9.184832e-01 3.671519e-01 2.154117e-02 4.186648e-01 8.103129e-01
##  [596] 7.588877e-01 1.242671e-01 2.831716e-01 2.605284e-01 4.580092e-01
##  [601] 1.122513e-01 1.159672e-02 8.051499e-01 2.565664e-02 2.449624e-01
##  [606] 7.335503e-01 2.050663e-01 3.322925e-02 6.316453e-01 1.027777e-01
##  [611] 2.736115e-01 9.855412e-01 6.797859e-01 2.178280e-01 3.377032e-01
##  [616] 5.650820e-01 4.494045e-01 3.652405e-01 9.583280e-01 3.271632e-01
##  [621] 9.473230e-01 8.257075e-01 9.201240e-01 1.422008e-02 1.970606e-01
##  [626] 1.525102e-02 2.391895e-01 4.825626e-01 2.471470e-01 7.633185e-01
##  [631] 6.973538e-01 9.306327e-01 5.416951e-01 5.466113e-01 1.465053e-01
##  [636] 3.564170e-01 7.037658e-01 4.982146e-01 6.921839e-01 2.282215e-01
##  [641] 7.494553e-01 2.321594e-03 2.151109e-04 1.534976e-01 9.465138e-01
##  [646] 1.069690e-01 5.358046e-01 1.989388e-01 6.117278e-01 7.216608e-01
##  [651] 2.209131e-01 6.504485e-01 5.812135e-01 9.562224e-01 5.062439e-02
##  [656] 2.587910e-01 4.413258e-01 8.512472e-01 6.739170e-02 1.350977e-02
##  [661] 6.036618e-01 5.073523e-01 9.490918e-01 1.617959e-01 7.132581e-02
##  [666] 1.343734e-01 1.310849e-01 5.243823e-01 5.589970e-01 3.012604e-01
##  [671] 2.426572e-03 3.104482e-01 8.966546e-01 7.114651e-01 2.960514e-01
##  [676] 8.504121e-01 5.976102e-01 9.051950e-01 5.641778e-01 2.947816e-01
##  [681] 1.913794e-03 9.071657e-01 8.937876e-01 5.038092e-01 1.498806e-01
##  [686] 2.411675e-02 2.933626e-03 6.537256e-01 4.841236e-01 2.588153e-02
##  [691] 1.141187e-01 6.017939e-01 8.904977e-01 9.157167e-01 1.615367e-01
##  [696] 5.396579e-01 1.194742e-01 5.423428e-01 9.239261e-01 9.239369e-01
##  [701] 7.194379e-02 7.724417e-01 4.018885e-01 2.728678e-01 5.847718e-01
##  [706] 3.747939e-01 8.528421e-01 7.157792e-01 5.491218e-01 4.223832e-01
##  [711] 6.250849e-02 2.356175e-03 5.486589e-01 3.554961e-01 8.728778e-01
##  [716] 8.538845e-01 7.293383e-01 4.206196e-01 9.965450e-01 1.550640e-02
##  [721] 2.228058e-01 3.240949e-01 6.122828e-01 4.934816e-01 7.925438e-01
##  [726] 3.114747e-02 8.635111e-02 4.041991e-01 2.959846e-01 2.172146e-02
##  [731] 5.841273e-01 6.647073e-01 1.316036e-01 7.722040e-01 4.964975e-01
##  [736] 8.958711e-01 9.063091e-01 8.340998e-02 9.937885e-01 1.173861e-01
##  [741] 7.123048e-01 5.047319e-01 6.147913e-01 5.097065e-01 2.745509e-02
##  [746] 8.782594e-01 5.096162e-02 3.005531e-01 5.108849e-01 3.587899e-01
##  [751] 9.148045e-03 3.579851e-01 9.846821e-01 8.868893e-03 8.916285e-01
##  [756] 3.334732e-01 3.043532e-02 7.041404e-01 1.893881e-01 2.690214e-01
##  [761] 6.702678e-01 3.837123e-01 2.478221e-01 7.308317e-01 1.790511e-01
##  [766] 7.363273e-01 6.682327e-01 2.637378e-01 9.886031e-01 4.464260e-01
##  [771] 3.809308e-01 6.657804e-01 8.566801e-01 4.697425e-01 2.696035e-02
##  [776] 1.066851e-01 3.763606e-01 7.942064e-02 6.299107e-01 2.929967e-01
##  [781] 7.889426e-01 1.552130e-02 2.070701e-01 1.111753e-01 2.238090e-01
##  [786] 5.222964e-01 6.534478e-01 8.411838e-01 3.351355e-02 5.385012e-01
##  [791] 7.302904e-01 8.568375e-01 2.565027e-01 9.795169e-01 5.953534e-01
##  [796] 2.716085e-01 3.680677e-01 3.658865e-01 4.372000e-01 9.287811e-01
##  [801] 1.587011e-02 6.653065e-02 3.058057e-01 5.549141e-01 7.956599e-01
##  [806] 6.477863e-01 9.983125e-01 2.544750e-02 8.875052e-03 5.562380e-02
##  [811] 9.775029e-01 3.247089e-02 2.970790e-01 7.655913e-01 4.301261e-02
##  [816] 7.297727e-05 4.363543e-01 6.787628e-01 5.724616e-01 4.367912e-02
##  [821] 3.896928e-01 6.004065e-01 6.738311e-01 2.290827e-01 3.009755e-01
##  [826] 7.296873e-01 4.913521e-01 7.300096e-02 8.696014e-01 6.662983e-01
##  [831] 7.419998e-01 2.232008e-01 5.837426e-01 8.215523e-01 8.827733e-02
##  [836] 9.734836e-01 3.582330e-01 4.705743e-01 1.609524e-01 8.824043e-01
##  [841] 5.473600e-01 6.599692e-01 2.649509e-02 4.782128e-01 2.792053e-01
##  [846] 4.196312e-02 2.409764e-01 3.152815e-01 8.137435e-01 6.981734e-01
##  [851] 5.440146e-01 3.429361e-01 2.439546e-02 5.931449e-01 9.074171e-01
##  [856] 3.223949e-01 6.832735e-01 5.706642e-02 6.998351e-01 2.952085e-01
##  [861] 8.545199e-01 4.700451e-01 7.522251e-01 8.400683e-01 8.315778e-01
##  [866] 9.543328e-01 5.203473e-01 3.999361e-02 6.842240e-01 3.477794e-01
##  [871] 7.489973e-01 2.723918e-01 1.913801e-01 2.865129e-02 7.525710e-01
##  [876] 4.522730e-01 2.689092e-01 3.927222e-01 9.419271e-01 5.070336e-01
##  [881] 8.599424e-01 2.763980e-01 6.614858e-01 6.160798e-01 1.886145e-03
##  [886] 2.627915e-01 5.580909e-01 5.204225e-02 2.588269e-01 3.184944e-01
##  [891] 8.108841e-01 2.774854e-01 7.772436e-01 7.399409e-01 3.178045e-01
##  [896] 3.470355e-01 6.604781e-01 5.777529e-01 1.025071e-01 6.651972e-01
##  [901] 5.628733e-01 7.019535e-01 7.747149e-01 3.902606e-01 1.326051e-01
##  [906] 7.301844e-01 8.575231e-01 2.218059e-01 6.698278e-01 1.293456e-01
##  [911] 3.279601e-01 9.980593e-01 8.860623e-01 7.967299e-01 2.665453e-01
##  [916] 1.502416e-01 2.854385e-01 4.775871e-02 2.131384e-01 3.778136e-02
##  [921] 4.227405e-01 3.856561e-02 3.394857e-01 7.950014e-01 3.963704e-01
##  [926] 4.075277e-01 7.679588e-01 1.340921e-01 7.555063e-01 1.573618e-01
##  [931] 4.895708e-01 2.044091e-01 9.800848e-01 4.463066e-02 3.670681e-01
##  [936] 6.448202e-02 7.696981e-01 3.999354e-01 2.644184e-01 9.604938e-02
##  [941] 3.787252e-01 3.194467e-01 5.733732e-03 2.285198e-01 6.698567e-01
##  [946] 8.111072e-01 8.210955e-01 4.079804e-01 1.285081e-01 7.045962e-01
##  [951] 8.849286e-03 6.822189e-01 2.335179e-02 3.397872e-01 8.105911e-01
##  [956] 8.020478e-01 9.227147e-01 3.291079e-01 7.528172e-02 1.822959e-01
##  [961] 9.113552e-01 7.148083e-01 9.615034e-02 9.091410e-01 2.738018e-02
##  [966] 5.243766e-01 9.261937e-01 8.817737e-01 6.966444e-01 5.666260e-01
##  [971] 2.531587e-01 4.674969e-01 5.663931e-01 1.458078e-01 7.696670e-01
##  [976] 6.706456e-01 3.110459e-01 2.914775e-01 1.956332e-01 4.423344e-02
##  [981] 8.958737e-01 1.439140e-01 6.009194e-01 3.688043e-02 2.232593e-01
##  [986] 1.035133e-01 7.319719e-02 9.809688e-01 6.027832e-01 7.252558e-01
##  [991] 3.585434e-01 6.285084e-01 9.583943e-01 2.503723e-01 2.084724e-02
##  [996] 6.994927e-01 5.724287e-01 4.851015e-01 4.743857e-01 8.202352e-02
```

```r
#Generate a histogram
par(mfrow = c(1,1))
hist(thousand_times, freq=F)
curve(dunif(x, 0, 1), 0, 1, add = T, col = "red", lwd = 2)
```

![](Assignment_4_files/figure-html/unnamed-chunk-8-1.png)<!-- -->

```r
sum(thousand_times<0.05)
```

```
## [1] 107
```

```r
#There are 107 instances where the p-vaule is less than 0.05
```


```r
#Change slope to 0
set.seed(720)
sig_pval <- function(a, b, lo, sd) {
x <- seq(from =1, to = 10, length.out=lo) 
y_deterministic <- a + b*x
y_simulated <- rnorm(length(x), mean = y_deterministic, sd)
mod_sim <- lm(y_simulated ~ x)

p_val_slope <- summary(mod_sim)$coef[2,4] 
p_val_slope
}

sig_pval(a=0.5, b=0.1, lo=20, sd=2)
```

```
## [1] 0.3620625
```

```r
thousand_times <- replicate(1000, sig_pval(a=0.5, b=0, lo=20, sd=2))
thousand_times
```

```
##    [1] 0.0891340241 0.7582004122 0.8381008726 0.3789338347 0.9120118368
##    [6] 0.0099531365 0.5508200613 0.8913535339 0.2818440708 0.9511384183
##   [11] 0.5187631953 0.8696611255 0.1106187447 0.0081117961 0.8520790803
##   [16] 0.3814384232 0.6656916704 0.1948888466 0.8597739347 0.4793835344
##   [21] 0.9309775851 0.9113443459 0.7812188215 0.1941971331 0.2091416131
##   [26] 0.9279971717 0.9882310235 0.0016830631 0.2316519688 0.8859455862
##   [31] 0.9585273843 0.5497008360 0.6488543187 0.1774200462 0.3680920850
##   [36] 0.8052509991 0.5786802095 0.3459317256 0.5112233361 0.0934573207
##   [41] 0.0487892445 0.5553214465 0.2593116960 0.3065796995 0.4449523021
##   [46] 0.6189822978 0.7067129579 0.0461527784 0.8979162693 0.8351320741
##   [51] 0.2668761520 0.1868757547 0.5385995089 0.5029319092 0.6915873831
##   [56] 0.6775862513 0.9213418919 0.3750358477 0.8477315035 0.8746292724
##   [61] 0.4409579010 0.5170057504 0.6707380937 0.3998604129 0.1622901531
##   [66] 0.5216196872 0.5652794745 0.1006454921 0.9543265781 0.4443054809
##   [71] 0.7131125598 0.5817955467 0.9008544296 0.3643242520 0.7434494507
##   [76] 0.0170112752 0.5058352245 0.9229679287 0.1798279108 0.2628667167
##   [81] 0.2473264740 0.4739908002 0.6203107097 0.6253291785 0.1660888242
##   [86] 0.7396031699 0.3795263612 0.0560200388 0.0947545110 0.9469580859
##   [91] 0.2618195808 0.5704273103 0.4869933876 0.0981981444 0.1369888355
##   [96] 0.3226545185 0.2873695571 0.3938082066 0.6409938515 0.1816089886
##  [101] 0.5696393049 0.8829772204 0.5235863011 0.4109560180 0.7019819943
##  [106] 0.3259185934 0.0668643574 0.2481940564 0.9633431721 0.7334544148
##  [111] 0.9962263106 0.5318652794 0.9051746551 0.8563865429 0.7152103830
##  [116] 0.5719566394 0.5828593889 0.6457301891 0.9988736377 0.1467304462
##  [121] 0.5042348833 0.2257265196 0.7243545888 0.1155918487 0.4103939561
##  [126] 0.2321916388 0.0018145278 0.7414106563 0.8903055656 0.2901598429
##  [131] 0.4724923864 0.3444131993 0.4690274637 0.8414197243 0.6413740197
##  [136] 0.7548016009 0.2037107153 0.4281288337 0.3690434650 0.6388068676
##  [141] 0.3668935974 0.4481152958 0.6078489156 0.5519591428 0.0640490680
##  [146] 0.5644965633 0.3099392420 0.6143567118 0.4541180576 0.2945532041
##  [151] 0.6590803423 0.6606884400 0.1103126127 0.6326502992 0.1127942671
##  [156] 0.4738635487 0.5891603783 0.2399963711 0.1980481034 0.2160261665
##  [161] 0.7312986625 0.9335657017 0.3625357677 0.3335166529 0.0509108471
##  [166] 0.6182240231 0.3789309960 0.9613352398 0.3136565218 0.3185180269
##  [171] 0.1392116818 0.6521218081 0.0993092002 0.3553009625 0.3119171737
##  [176] 0.0505933116 0.1110602430 0.8670792143 0.7319191130 0.7686534015
##  [181] 0.7323277772 0.2118301506 0.6704554774 0.4829279455 0.1199145483
##  [186] 0.7790482016 0.6937594784 0.5689939544 0.7424838147 0.6883504704
##  [191] 0.1790683839 0.0041865783 0.8017725343 0.7012170193 0.5875221764
##  [196] 0.5766051825 0.2164698413 0.8208705582 0.5584555653 0.9131153839
##  [201] 0.6510043646 0.1346044471 0.4036249263 0.8976277640 0.3842520278
##  [206] 0.2202586611 0.6625210530 0.8759373683 0.9901279331 0.5191584086
##  [211] 0.0511356402 0.3875051445 0.6658582470 0.2636072719 0.7193772838
##  [216] 0.2162702985 0.5570993752 0.9963033390 0.6266588472 0.4066997406
##  [221] 0.6390211318 0.5253324938 0.5336175608 0.0984027875 0.8418442227
##  [226] 0.6497456321 0.0034662364 0.8839500305 0.7360434866 0.9272352038
##  [231] 0.0099735946 0.7157973035 0.9527154954 0.1866475233 0.3279317224
##  [236] 0.1444488857 0.4782120398 0.4142014831 0.9796988442 0.0734044598
##  [241] 0.1232919457 0.9224855875 0.9814755679 0.7636919658 0.0029496246
##  [246] 0.4535943354 0.0416257413 0.1267062379 0.0128453417 0.6617018477
##  [251] 0.6485646728 0.8255288039 0.1791430543 0.2998545724 0.1148214815
##  [256] 0.6540180851 0.0374491187 0.9599632506 0.3628696393 0.4331804252
##  [261] 0.3549816451 0.7045607056 0.7204380612 0.2305525475 0.2924355242
##  [266] 0.7789797633 0.3143243828 0.9961861998 0.2490777053 0.6637828138
##  [271] 0.7795868253 0.6026280352 0.1674279620 0.9379427282 0.1793998419
##  [276] 0.5337497223 0.9271254511 0.2261147756 0.9564930980 0.1275250344
##  [281] 0.3501335248 0.2464311086 0.5622215490 0.9298723089 0.6731369539
##  [286] 0.5376076675 0.5843016935 0.7129222426 0.3872287318 0.4710886765
##  [291] 0.3535587228 0.8995054836 0.9271940593 0.3010327894 0.7120954502
##  [296] 0.7381840126 0.0440660165 0.3973884947 0.3097483229 0.9195706424
##  [301] 0.2720711063 0.5261069463 0.0440814746 0.6067597136 0.6445210367
##  [306] 0.5117626446 0.2417138104 0.2246616214 0.5810995578 0.8923462381
##  [311] 0.6962923488 0.7330600361 0.9897033841 0.8516145958 0.6670758164
##  [316] 0.2046006702 0.7347595845 0.7940273215 0.7894424224 0.2035599233
##  [321] 0.8624989683 0.2323678662 0.5301160659 0.0020777724 0.6617539817
##  [326] 0.2055017794 0.8853243952 0.0747234472 0.1938267947 0.5998336392
##  [331] 0.9276259256 0.5898020313 0.0063273530 0.7583872283 0.8919171463
##  [336] 0.0800328616 0.2862545383 0.4633567476 0.0870664637 0.5702783385
##  [341] 0.6928470918 0.3688229546 0.6921162037 0.2789983308 0.2703161874
##  [346] 0.6988838253 0.6223463145 0.0199776028 0.0743653644 0.1063489488
##  [351] 0.3023449683 0.3739388188 0.9137430290 0.9591553711 0.0400523694
##  [356] 0.0476370461 0.4377484408 0.6716855735 0.0738859847 0.9019079131
##  [361] 0.7145293432 0.8872444851 0.0429078170 0.0340936753 0.3817693335
##  [366] 0.0798820009 0.6783383137 0.4510425262 0.4848629942 0.8289894084
##  [371] 0.3687301733 0.8653621713 0.5390313545 0.0639713996 0.1622971328
##  [376] 0.0660299313 0.5928311340 0.3498684700 0.2239882405 0.8569325830
##  [381] 0.8149479778 0.6387872137 0.4201585313 0.3707940726 0.6479323220
##  [386] 0.2516802488 0.0012624434 0.2621783366 0.2051072960 0.3693957986
##  [391] 0.9247060301 0.9903557167 0.7699369908 0.4159398387 0.3905333257
##  [396] 0.5382676203 0.3232206843 0.3002407178 0.8767059938 0.7550178799
##  [401] 0.3595183369 0.9281965789 0.2604034687 0.8614311835 0.6493031910
##  [406] 0.1367931704 0.9088543739 0.8981867753 0.7834237412 0.2604969271
##  [411] 0.5353363071 0.2501311918 0.4491921242 0.9538770556 0.0385266558
##  [416] 0.8297109796 0.4526743236 0.5196489025 0.2570501972 0.2168541666
##  [421] 0.7264006224 0.8868085137 0.9883460309 0.0824284549 0.4485339440
##  [426] 0.4664107813 0.9324227490 0.5159970164 0.1140694830 0.5317516925
##  [431] 0.9629992852 0.5824655321 0.2507236101 0.5195309601 0.4074227619
##  [436] 0.0167617260 0.9460313563 0.9129025209 0.2435870441 0.7269731652
##  [441] 0.5337706178 0.7012324919 0.8794517414 0.4385796546 0.3221262182
##  [446] 0.5723329559 0.6720562746 0.3928164364 0.0005204037 0.0574723594
##  [451] 0.4870873644 0.6533367367 0.9159850603 0.1221402748 0.0360304123
##  [456] 0.6666000571 0.3708743012 0.3888723105 0.9188255180 0.7311543798
##  [461] 0.2530650170 0.5597236530 0.9765726711 0.3539863845 0.6783253257
##  [466] 0.0616363485 0.0487354664 0.9642398167 0.2552286324 0.4815683679
##  [471] 0.9435806323 0.3486661312 0.2032168253 0.3129781411 0.5675048307
##  [476] 0.7003104466 0.3213577504 0.3192202508 0.4006873309 0.2764658149
##  [481] 0.8990902029 0.3668355679 0.8928922342 0.4033242028 0.1300029646
##  [486] 0.0918652423 0.5882330584 0.0045078466 0.1734128084 0.2014567783
##  [491] 0.1552908500 0.2411346935 0.8405433158 0.8139754616 0.0391165446
##  [496] 0.6267578178 0.9186797040 0.6699547494 0.7865926374 0.5129547673
##  [501] 0.5299357006 0.8994023393 0.1622597768 0.1243010120 0.4316025656
##  [506] 0.8357265234 0.3154830705 0.0716090970 0.8957728347 0.6664574236
##  [511] 0.7786703109 0.2375800294 0.1795846606 0.4045711421 0.7008644445
##  [516] 0.1205859004 0.6494671416 0.5291110257 0.0210725073 0.6076557765
##  [521] 0.9904520844 0.7095531104 0.0442779534 0.1107871231 0.7387795325
##  [526] 0.9447334454 0.4136487879 0.5480773739 0.6594020871 0.3968872493
##  [531] 0.2792982188 0.6625132696 0.1731624120 0.1469111546 0.3399173155
##  [536] 0.9495444632 0.2226070326 0.4423384203 0.1947115325 0.9270807277
##  [541] 0.8263544840 0.1697011037 0.7236266307 0.6084928463 0.3035392240
##  [546] 0.8647264100 0.2089377762 0.8734366596 0.4454420090 0.0494728492
##  [551] 0.5614606170 0.0779566377 0.7538179871 0.3193960762 0.8930361340
##  [556] 0.6167044006 0.0780254777 0.5668061918 0.3496568819 0.7670113940
##  [561] 0.7352186439 0.6064658448 0.2202445877 0.5909288934 0.0126703368
##  [566] 0.0337019471 0.4459388503 0.4971973346 0.6984391456 0.1808273159
##  [571] 0.9543055597 0.1181407017 0.6835331347 0.6653663448 0.5356832167
##  [576] 0.2275248602 0.2813880650 0.1381421338 0.5775234649 0.7290277648
##  [581] 0.4102984756 0.4721444979 0.0660257485 0.4958460848 0.2590235244
##  [586] 0.9903953157 0.4491911443 0.0504906678 0.0609509517 0.6974788117
##  [591] 0.5742140713 0.7932032002 0.0724551957 0.8385056639 0.5569820956
##  [596] 0.7635609106 0.4617426288 0.6379295362 0.5728331176 0.8356572717
##  [601] 0.0340956822 0.0451180199 0.3874590192 0.0842660522 0.6170581367
##  [606] 0.8272326382 0.5547537572 0.0941480632 0.7287723374 0.1965958314
##  [611] 0.5431113498 0.4593796015 0.8129349646 0.4350717916 0.6885338194
##  [616] 0.2919304356 0.2204862875 0.6855413798 0.6611704635 0.7181035828
##  [621] 0.5841788476 0.3774847527 0.4892368473 0.0466152096 0.4062598537
##  [626] 0.0460366537 0.5091863282 0.2353820676 0.0888713578 0.3623560059
##  [631] 0.8532311855 0.5136854317 0.2811494585 0.9348827305 0.0270686080
##  [636] 0.6358151887 0.8169013132 0.2274163542 0.3132264013 0.5924475243
##  [641] 0.7982778060 0.0209888587 0.0013074846 0.4133795877 0.3946392235
##  [646] 0.2459804886 0.9375459945 0.0828098741 0.2202683265 0.4111844873
##  [651] 0.5541796307 0.7915056096 0.2957358651 0.5121931705 0.0114621052
##  [656] 0.4822701725 0.1603079419 0.6802519752 0.1651264259 0.0575494086
##  [661] 0.9471868960 0.1523873032 0.6547726499 0.0538129497 0.0210373569
##  [666] 0.0511328314 0.3359221027 0.2054685759 0.1998194126 0.5865427945
##  [671] 0.0108135487 0.6784882780 0.5605097921 0.2919055570 0.6753450160
##  [676] 0.7874990223 0.9019156159 0.7153422888 0.9923896710 0.7379472328
##  [681] 0.0153034777 0.6569238272 0.5645090668 0.2359026638 0.3821164080
##  [686] 0.0770953518 0.0198962427 0.3446033327 0.9917237617 0.0781125837
##  [691] 0.4830557820 0.1673926525 0.4292676859 0.4914169977 0.4410080846
##  [696] 0.9834188937 0.3442786309 0.9666799525 0.4698155368 0.3794135034
##  [701] 0.2454343024 0.7071170446 0.7100357408 0.6568406727 0.7730620297
##  [706] 0.6546013395 0.5269325810 0.3074612487 0.2493613875 0.8627960647
##  [711] 0.2006281787 0.0155703711 0.9240311032 0.7609131991 0.4699344464
##  [716] 0.6049929043 0.7692294822 0.9897701611 0.4978964992 0.0703000082
##  [721] 0.4774556466 0.8189373523 0.9233835638 0.9310167114 0.6602877616
##  [726] 0.1015923412 0.2842228022 0.9826463499 0.8551579250 0.0645427028
##  [731] 0.2809157708 0.9544248435 0.4698763772 0.4483423535 0.9203196918
##  [736] 0.7026922415 0.6464712962 0.2547734530 0.4855683879 0.4113039045
##  [741] 0.2801018571 0.1734799944 0.3117684343 0.9694523321 0.0904543069
##  [746] 0.6022967246 0.1815142539 0.1360443267 0.9013875408 0.6496894645
##  [751] 0.0480001032 0.1537602641 0.5380188996 0.0362982125 0.4868617755
##  [756] 0.7282599272 0.1223636420 0.8395270554 0.0536488237 0.7383133545
##  [761] 0.3243132501 0.8900302326 0.5221227665 0.7046524608 0.0623747130
##  [766] 0.6688623663 0.8951123424 0.1000082383 0.4667895749 0.8057545652
##  [771] 0.6972357407 0.8217832588 0.5934895091 0.9184915678 0.0908578192
##  [776] 0.2890983245 0.8549063449 0.2224311478 0.8124623474 0.6897811972
##  [781] 0.5139699566 0.0430274621 0.6238234269 0.0239216357 0.5042022307
##  [786] 0.1717964318 0.6820404525 0.7597787921 0.1120609115 0.2556040865
##  [791] 0.3462756211 0.3929120784 0.5385502404 0.4722645506 0.9980605555
##  [796] 0.6041188041 0.7209002443 0.8014223858 0.1472598788 0.4886208860
##  [801] 0.1000423577 0.2486957809 0.6978727539 0.2290926821 0.5367422581
##  [806] 0.8291894024 0.5961774312 0.0822727376 0.0392523651 0.1915037052
##  [811] 0.4455088347 0.1092908862 0.1145123138 0.7424112999 0.0085606748
##  [816] 0.0011837682 0.1702109050 0.8705331756 0.9849295992 0.1314814812
##  [821] 0.7834927703 0.7767622681 0.8522284094 0.5707157961 0.7386466798
##  [826] 0.7280855576 0.9956678592 0.0148647225 0.5560570826 0.1976585159
##  [831] 0.4450660491 0.0687681006 0.2024049366 0.4277528320 0.2528969978
##  [836] 0.5057251240 0.6529596833 0.1639184905 0.7258494592 0.7223441542
##  [841] 0.2195109635 0.7370047736 0.0962336321 0.9609498795 0.6957142765
##  [846] 0.2025883974 0.0958141683 0.5649286516 0.4350886064 0.3551682072
##  [851] 0.9293785642 0.1504491309 0.0768263421 0.9389454434 0.5883353978
##  [856] 0.1284395366 0.3298274659 0.1852631584 0.2913075820 0.6445038654
##  [861] 0.6236461175 0.1148425716 0.3632513908 0.6976000277 0.4604594787
##  [866] 0.6332694192 0.9668449591 0.1812876692 0.2592653790 0.7697174395
##  [871] 0.6770065630 0.6415445021 0.5034051764 0.1042565054 0.3440400183
##  [876] 0.7798668432 0.5805471755 0.7823482500 0.5280462644 0.8515186030
##  [881] 0.4687356037 0.6113383075 0.9210981347 0.8887367548 0.0080478001
##  [886] 0.6005546631 0.9770689823 0.1567746484 0.5261045370 0.7063329156
##  [891] 0.4203603042 0.6824453392 0.7988931350 0.4108366709 0.1197138400
##  [896] 0.7390027203 0.8721883102 0.9798006756 0.3002191375 0.8399174042
##  [901] 0.9847414759 0.3273479018 0.6208019663 0.1593534695 0.4041969550
##  [906] 0.3349612842 0.7227682672 0.5061988371 0.3411559671 0.3883569392
##  [911] 0.7353545619 0.5380517870 0.5026983156 0.4507557550 0.0926900850
##  [916] 0.3942893498 0.7464767633 0.1131774528 0.0822345698 0.2033436749
##  [921] 0.8722965607 0.1340653561 0.7903404577 0.7264036836 0.8154884924
##  [926] 0.7905066684 0.8228899920 0.4157093508 0.7822661448 0.0343894600
##  [931] 0.9662029019 0.4672564247 0.5820465316 0.1580088707 0.7482037397
##  [936] 0.3070725936 0.8927405335 0.7808810392 0.6440624036 0.2829214038
##  [941] 0.7250640949 0.7313402556 0.0015338723 0.6702431864 0.8940173824
##  [946] 0.7970369337 0.5521811369 0.1563384240 0.2791621538 0.3735171611
##  [951] 0.0449734165 0.7782769921 0.0690956276 0.8302011735 0.7442926093
##  [956] 0.6408378800 0.7094183286 0.6972435232 0.2708324543 0.4531074365
##  [961] 0.4449564137 0.7536443289 0.3132247596 0.5412994233 0.1106412128
##  [966] 0.9389449864 0.7045215389 0.7246269003 0.2974051038 0.2423099304
##  [971] 0.7632529609 0.8575272534 0.9622116526 0.4392004982 0.3783123585
##  [976] 0.9343182388 0.7360870179 0.1103221756 0.5077161905 0.1357000354
##  [981] 0.4815797061 0.3505238412 0.9648242925 0.1125454359 0.5636335977
##  [986] 0.3122947615 0.2782444235 0.5448636781 0.9379444820 0.6602080962
##  [991] 0.7897475494 0.8167915104 0.6289349185 0.5600205031 0.0648156898
##  [996] 0.8472858606 0.9595578758 0.1842462453 0.7799983764 0.2286881210
```

```r
par(mfrow = c(1,1))
hist(thousand_times, freq=F)
curve(dunif(x, 0, 1), 0, 1, add = T, col = "red", lwd = 2)
```

![](Assignment_4_files/figure-html/unnamed-chunk-9-1.png)<!-- -->

```r
sum(thousand_times<0.05)
```

```
## [1] 61
```

```r
#There are 61 instances where the p-value is less than 0.05. By changing the slope to 0, there are fewer instances where the p-value < 0.05, this indicates that more points are found along the slope of 0.1 and less on the slope of 0, meaning the slope of 0.1 is more statistically significant. 
```




```r
#Using a for loop
set.seed(720)
pval_less0.05 <- function(a, b, sd){
  
pvals <- integer()
forplot <- matrix(data = NA, nrow = 19, ncol = 2)
n=10

for(j in 1:10000){

x <- seq(from =1, to = 10, length.out = n)
y_deterministic <- a + b*x
  
for(i in 1:100) {
y_simulated <-rnorm(length(x), mean = y_deterministic, sd)
mod_sim <- lm(y_simulated ~ x)
p_val_slope <- summary(mod_sim)$coef[2,4]
pvals[i] <- p_val_slope
}

pless0.05 <- which(pvals < 0.05) 
forplot[j,2] <- (length(pless0.05))/100
forplot[j,1] <- n
n =  n + 5
if( n > 100){ 
break
}
}
print(forplot)
plot( x = forplot[,1], y = forplot[,2], type = "p", xlab = "Sample Size", ylab = "Proportion of < 0.05", main = "Effect of Sample size on P Value Significance", col = "red", pch = 16)
}

pval_less0.05(0.5, 0.1, 1.5)
```

```
##       [,1] [,2]
##  [1,]   10 0.12
##  [2,]   15 0.12
##  [3,]   20 0.11
##  [4,]   25 0.12
##  [5,]   30 0.21
##  [6,]   35 0.25
##  [7,]   40 0.27
##  [8,]   45 0.20
##  [9,]   50 0.23
## [10,]   55 0.17
## [11,]   60 0.31
## [12,]   65 0.25
## [13,]   70 0.33
## [14,]   75 0.42
## [15,]   80 0.33
## [16,]   85 0.41
## [17,]   90 0.39
## [18,]   95 0.42
## [19,]  100 0.46
```

![](Assignment_4_files/figure-html/unnamed-chunk-10-1.png)<!-- -->



